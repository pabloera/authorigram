{
  "stage": "04_feature_validation",
  "stage_result": {
    "stage": "04_feature_validation",
    "timestamp": "2025-06-08T05:32:47.765513",
    "success": true,
    "datasets_processed": 1,
    "results": {},
    "anthropic_used": false,
    "execution_time": 0.018913745880126953,
    "memory_usage": "psutil not available",
    "feature_validation_reports": {
      "data/uploads/test_dataset_comprehensive.csv": {
        "report": {
          "timestamp": "2025-06-08T05:32:47.773109",
          "total_records": 98,
          "text_columns": [
            "body"
          ],
          "existing_features_detected": [],
          "validations_performed": [],
          "enrichments_added": [],
          "skipped_features": [
            "structural_patterns (j√° existem)"
          ],
          "issues_found": [],
          "media_validation": {
            "original_media_types": {},
            "updated_count": 2,
            "detection_method": "content_analysis",
            "created_column": true,
            "final_media_types": {
              "text": 96,
              "video": 2
            }
          },
          "text_metrics": {
            "metrics_added": [
              "text_length",
              "word_count"
            ],
            "primary_text_column": "body"
          },
          "structural_patterns": {
            "patterns_detected": [],
            "forwarded_messages": 0,
            "messages_with_mentions": 0
          },
          "quality_flags": {
            "quality_flags_added": [
              "is_very_short",
              "is_very_long"
            ],
            "low_quality_messages": "2"
          }
        },
        "output_path": "data/interim/test_dataset_comprehensive_01b_features_validated.csv"
      }
    }
  },
  "pipeline_state": {
    "start_time": "2025-06-08 05:32:36.238399",
    "current_stage": "04_feature_validation",
    "completed_stages": [
      "01_chunk_processing",
      "02_encoding_validation",
      "03_deduplication",
      "04_feature_validation"
    ],
    "failed_stages": [],
    "stage_results": {
      "01_chunk_processing": {
        "stage": "01_chunk_processing",
        "timestamp": "2025-06-08T05:32:36.238785",
        "success": true,
        "datasets_processed": 1,
        "results": {},
        "anthropic_used": false,
        "execution_time": 0.00825190544128418,
        "memory_usage": "psutil not available",
        "chunks_processed": {
          "data/uploads/test_dataset_comprehensive.csv": {
            "records": 100,
            "success": true
          }
        },
        "validation_reports": {
          "data/uploads/test_dataset_comprehensive.csv": {
            "total_records": 100,
            "columns": [
              "id",
              "body",
              "date",
              "channel",
              "author",
              "message_id",
              "forwards",
              "views",
              "replies"
            ],
            "memory_usage": "0.01 MB",
            "chunk_processed": true
          }
        }
      },
      "02_encoding_validation": {
        "stage": "02_encoding_validation",
        "timestamp": "2025-06-08T05:32:36.247304",
        "success": true,
        "datasets_processed": 1,
        "results": {},
        "anthropic_used": false,
        "execution_time": 0.016900300979614258,
        "memory_usage": "psutil not available",
        "encoding_reports": {
          "data/uploads/test_dataset_comprehensive.csv": {
            "timestamp": "2025-06-08T05:32:36.263728",
            "total_records": 100,
            "text_columns_analyzed": [
              "body",
              "channel"
            ],
            "quick_analysis": {
              "body": {
                "total_values": 100,
                "non_null_values": "100",
                "problematic_chars_count": 0,
                "encoding_artifacts_count": 0,
                "problematic_patterns": []
              },
              "channel": {
                "total_values": 100,
                "non_null_values": "100",
                "problematic_chars_count": 0,
                "encoding_artifacts_count": 0,
                "problematic_patterns": []
              }
            },
            "detailed_analysis": {},
            "overall_quality_score": 1.0,
            "recommendations": [
              "Qualidade de encoding satisfat√≥ria - nenhuma a√ß√£o necess√°ria"
            ]
          }
        },
        "corrections_applied": {
          "data/uploads/test_dataset_comprehensive.csv": {
            "corrections": 0,
            "output_path": "data/uploads/test_dataset_comprehensive_02a_encoding_validated.csv",
            "success": true,
            "message": "Nenhuma corre√ß√£o necess√°ria"
          }
        }
      },
      "03_deduplication": {
        "stage": "03_deduplication",
        "timestamp": "2025-06-08T05:32:36.264596",
        "success": true,
        "datasets_processed": 1,
        "results": {},
        "anthropic_used": true,
        "execution_time": 11.49790906906128,
        "memory_usage": "psutil not available",
        "deduplication_reports": {
          "data/uploads/test_dataset_comprehensive.csv": {
            "report": {
              "method": "intelligent_anthropic",
              "original_count": 100,
              "deduplicated_count": 98,
              "duplicates_removed": 2,
              "reduction_ratio": 0.02,
              "validation": {
                "timestamp": "2025-06-08T05:32:36.269250",
                "original_count": 100,
                "deduplicated_count": 98,
                "reduction_ratio": 0.02,
                "text_column_used": "body",
                "media_analysis": {
                  "media_detection_original": {
                    "photo": {
                      "count": "0",
                      "percentage": 0.0
                    },
                    "video": {
                      "count": "0",
                      "percentage": 0.0
                    },
                    "audio": {
                      "count": "0",
                      "percentage": 0.0
                    },
                    "document": {
                      "count": "0",
                      "percentage": 0.0
                    },
                    "sticker": {
                      "count": "2",
                      "percentage": 2.0
                    },
                    "location": {
                      "count": "0",
                      "percentage": 0.0
                    }
                  },
                  "media_detection_deduplicated": {},
                  "exclusion_validation": {
                    "media_incorrectly_included": 2,
                    "total_media_messages": 2,
                    "exclusion_rate": 0.0,
                    "issues_found": [
                      "Mensagem de m√≠dia incorretamente inclu√≠da: Emojis: üòÄüòÅüòÇü§£üòÉüòÑüòÖüòÜüòâüòä...",
                      "Mensagem de m√≠dia incorretamente inclu√≠da: Amo minha fam√≠lia e meus amigos ‚ù§Ô∏è..."
                    ]
                  }
                },
                "duplicate_count_validation": {
                  "column_exists": true,
                  "statistics": {
                    "min_count": 1,
                    "max_count": 2,
                    "mean_count": 1.02,
                    "total_duplicates_counted": 100,
                    "records_with_duplicates": 2,
                    "percentage_with_duplicates": 2.04
                  },
                  "validation_issues": [],
                  "size_consistency": {
                    "expected_original_size": 100,
                    "actual_deduplicated_size": 98,
                    "ratio": 1.02
                  }
                },
                "coordination_analysis": {
                  "potential_coordination": [],
                  "statistics": {},
                  "suspicious_patterns": []
                },
                "quality_assessment": {
                  "overall_score": 0.19999999999999996,
                  "quality_level": "ruim",
                  "quality_factors": [
                    "Taxa de exclus√£o de m√≠dia baixa: 0.0%",
                    "Taxa de redu√ß√£o suspeita: 2.0%",
                    "Qualidade avaliada como ruim pela API"
                  ]
                },
                "recommendations": [
                  "Revisar algoritmo de deduplica√ß√£o",
                  "Considerar similaridade sem√¢ntica, n√£o apenas textual",
                  "Implementar compara√ß√£o mais robusta de conte√∫do",
                  "Melhorar detec√ß√£o de mensagens de m√≠dia antes da deduplica√ß√£o",
                  "Adicionar tratamento de varia√ß√µes de texto",
                  "Reprocessar deduplica√ß√£o com par√¢metros ajustados"
                ],
                "api_analysis": {
                  "quality_assessment": {
                    "reduction_rate_appropriate": false,
                    "duplicate_counts_seem_accurate": false,
                    "coordination_patterns_detected": true,
                    "overall_quality": "ruim",
                    "confidence": "medio"
                  },
                  "issues_identified": [
                    "Taxa de redu√ß√£o muito baixa (2%)",
                    "Todos os registros t√™m duplicate_count = 1",
                    "Mensagens parecem ser geradas artificialmente",
                    "Falta de varia√ß√£o real no conte√∫do"
                  ],
                  "recommendations": [
                    "Revisar algoritmo de deduplica√ß√£o",
                    "Implementar compara√ß√£o mais robusta de conte√∫do",
                    "Considerar similaridade sem√¢ntica, n√£o apenas textual",
                    "Adicionar tratamento de varia√ß√µes de texto"
                  ],
                  "coordination_analysis": {
                    "suspicious_patterns": [
                      "Mensagens de teste numeradas sequencialmente",
                      "Conte√∫do muito similar",
                      "Uso de hashtags padronizadas"
                    ],
                    "likely_bot_activity": true,
                    "organic_vs_coordinated_ratio": "80% coordenado / 20% org√¢nico"
                  }
                }
              },
              "duplicate_frequency_added": true
            },
            "output_path": "data/interim/test_dataset_comprehensive_02b_deduplicated.csv"
          }
        }
      },
      "04_feature_validation": {
        "stage": "04_feature_validation",
        "timestamp": "2025-06-08T05:32:47.765513",
        "success": true,
        "datasets_processed": 1,
        "results": {},
        "anthropic_used": false,
        "execution_time": 0.018913745880126953,
        "memory_usage": "psutil not available",
        "feature_validation_reports": {
          "data/uploads/test_dataset_comprehensive.csv": {
            "report": {
              "timestamp": "2025-06-08T05:32:47.773109",
              "total_records": 98,
              "text_columns": [
                "body"
              ],
              "existing_features_detected": [],
              "validations_performed": [],
              "enrichments_added": [],
              "skipped_features": [
                "structural_patterns (j√° existem)"
              ],
              "issues_found": [],
              "media_validation": {
                "original_media_types": {},
                "updated_count": 2,
                "detection_method": "content_analysis",
                "created_column": true,
                "final_media_types": {
                  "text": 96,
                  "video": 2
                }
              },
              "text_metrics": {
                "metrics_added": [
                  "text_length",
                  "word_count"
                ],
                "primary_text_column": "body"
              },
              "structural_patterns": {
                "patterns_detected": [],
                "forwarded_messages": 0,
                "messages_with_mentions": 0
              },
              "quality_flags": {
                "quality_flags_added": [
                  "is_very_short",
                  "is_very_long"
                ],
                "low_quality_messages": "2"
              }
            },
            "output_path": "data/interim/test_dataset_comprehensive_01b_features_validated.csv"
          }
        }
      }
    },
    "checkpoints": {
      "01_chunk_processing": "/Users/pabloalmada/development/project/dataanalysis-bolsonarismo/checkpoints/pipeline_01_chunk_processing_20250608_053236.json",
      "02_encoding_validation": "/Users/pabloalmada/development/project/dataanalysis-bolsonarismo/checkpoints/pipeline_02_encoding_validation_20250608_053236.json",
      "03_deduplication": "/Users/pabloalmada/development/project/dataanalysis-bolsonarismo/checkpoints/pipeline_03_deduplication_20250608_053247.json"
    },
    "data_versions": {
      "data/interim/test_dataset_comprehensive_02b_deduplicated.csv": "2025-06-08T05:32:47.762105",
      "data/interim/test_dataset_comprehensive_01b_features_validated.csv": "2025-06-08T05:32:47.784309"
    },
    "initialization_errors": []
  },
  "timestamp": "2025-06-08T05:32:47.784615"
}